---
interface Props {
  targetISO: string;
  label?: string;
}

const { targetISO } = Astro.props;
---

<div
  data-countdown
  data-target={targetISO}
  class="w-full border-t-[0.5px] border-b-[0.5px] border-white py-1"
>
  <div class="w-full border-t-[0.5px] border-b-[0.5px] border-white px-32">
    <div class="w-full border-l-[0.5px] border-r-[0.5px] border-white px-1">
        <div class="w-full border-l-[0.5px] border-r-[0.5px] border-white">
      <div class="flex items-center justify-center gap-4 px-4 py-10 lg:text-3xl">
        <p class="tracking-widest text-gray-300 font-hakushu">第七十五回筑駒文化祭まで</p>
        <p data-days class="text-8xl font-bold">00</p>
        <p class="tracking-widest text-gray-300 font-hakushu">日</p>
      </div>
      </div>
    </div>
  </div>
</div>

<script>
  const roots = document.querySelectorAll("[data-countdown]");

  const pad = (value: number) => String(value).padStart(2, "0");

  roots.forEach((root) => {
    const targetText = root.getAttribute("data-target");
    const target = targetText ? new Date(targetText).getTime() : NaN;
    const daysEl = root.querySelector("[data-days]");

    if (!Number.isFinite(target) || !daysEl) {
      return;
    }

    const render = () => {
      const now = Date.now();
      const diff = Math.max(0, target - now);
      const days = Math.floor(diff / (1000 * 60 * 60 * 24));

      daysEl.textContent = pad(days);
    };

    render();
    setInterval(render, 1000);
  });
</script>